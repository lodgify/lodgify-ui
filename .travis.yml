language: node_js
node_js:
  - '10'

script:
  - npm run install-peers
  - npm run lint
  - npm run test:ci
  - npm run build
  - npm run size
  - npm run styleguide:build

notifications:
  email: false

deploy:
  # Publish styleguide to GitHub Pages
  - github-token: $GITHUB_TOKEN
    keep-history: true
    local-dir: './styleguide/dist'
    on:
      branch: master
    provider: pages
  # Release npm
  - provider: script
    on:
      branch: master
    script:
      - npx semantic-release
